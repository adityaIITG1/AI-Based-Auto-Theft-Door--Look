<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ARGUS | ATM Security Intelligence</title>
  <link rel="stylesheet" href="style.css" />
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>

<body>
  <!-- Top Bar -->
  <header class="topbar">
    <div class="brand">
      <img src="nextgen-logo.png" alt="Next Gen Developers Logo" class="ngd-logo" />
      <div class="brand-text">
        <h1>ARGUS</h1>
        <p>AI-powered Robbery Guard & Unified Surveillance</p>
      </div>
    </div>

    <div class="top-right">
      <div class="chips">
        <div class="chip">ATM-ID: <b id="atmId">ATM-01</b></div>
        <div class="chip">Location: <b id="atmLoc">Prayagraj</b></div>
        <div class="chip">Role: <b id="roleText">GUARD</b></div>
      </div>

      <div class="statusRow">
        <div id="netPill" class="pill net online">ONLINE</div>
        <div id="statusPill" class="pill safe">SAFE</div>
      </div>
    </div>
  </header>

  <!-- Main Layout -->
  <main class="layout">

    <!-- LEFT SIDEBAR: Cameras + Roles + Search -->
    <aside class="card sidebar">
      <div class="card-head">
        <h2>Cameras</h2>
        <span class="hint">Switch live feeds</span>
      </div>

      <div class="searchBox">
        <input id="camSearch" placeholder="Search camera…" />
      </div>

      <div id="camList" class="camList"></div>

      <div class="divider"></div>

      <div class="card-head">
        <h2>User & Controls</h2>
        <span class="hint">Access control</span>
      </div>

      <div class="roleBox">
        <button id="roleGuardBtn" class="btn small primary">Guard View</button>
        <button id="roleAdminBtn" class="btn small">Admin View</button>
      </div>

      <div class="toggleRow">
        <label class="toggle">
          <input type="checkbox" id="soundToggle" checked />
          <span class="slider"></span>
        </label>
        <div>
          <div class="toggleTitle">Alert Sound</div>
          <div class="toggleSub">Beep on CRITICAL</div>
        </div>
      </div>

      <div class="toggleRow">
        <label class="toggle">
          <input type="checkbox" id="autoLockToggle" checked />
          <span class="slider"></span>
        </label>
        <div>
          <div class="toggleTitle">Auto Gate Lock</div>
          <div class="toggleSub">Lock when risk is high</div>
        </div>
      </div>

      <div class="toggleRow">
        <label class="toggle">
          <input type="checkbox" id="flashToggle" checked />
          <span class="slider"></span>
        </label>
        <div>
          <div class="toggleTitle">Critical Flash</div>
          <div class="toggleSub">Flash border on CRITICAL</div>
        </div>
      </div>
    </aside>

    <!-- CENTER: Camera + Overlay + Snapshot Gallery -->
    <section class="card camera" id="cameraCard">
      <div class="card-head">
        <h2>Live Camera Feed</h2>
        <span class="hint">Real-time monitoring (demo)</span>
      </div>

      <div class="videoBox" id="videoBox">
        <div class="videoTop">
          <div class="camLabel" id="camLabel">CAM-1 • ATM Lobby</div>
          <div class="liveTag">LIVE</div>
        </div>

        <!-- For real backend stream later:
             <img id="mjpeg" class="mjpeg" src="http://127.0.0.1:8000/video" alt="Live Feed">
             For now we keep placeholder: -->
        <img id="mjpeg" class="mjpeg" src="http://127.0.0.1:8000/video" alt="Live CCTV Feed" />


        <!-- Fake bbox overlays (demo). Later connect to real detections -->
        <div class="bboxLayer" id="bboxLayer"></div>
      </div>

      <div class="actionRow">
        <button class="btn primary" id="notifyGuardBtn">Notify Guard</button>
        <button class="btn" id="notifyPoliceBtn">Notify Police</button>
        <button class="btn" id="saveClipBtn">Save 30s Clip</button>
        <button class="btn" id="snapshotBtn">Save Snapshot</button>
      </div>

      <div class="card-head" style="margin-top:14px;">
        <h2>Evidence Snapshots</h2>
        <span class="hint">Click to view</span>
      </div>

      <div class="snapGrid" id="snapGrid">
        <div class="mutedBox">No snapshots yet</div>
      </div>
    </section>

    <!-- RIGHT: Risk + Radar + Remote Controls + Acknowledge -->
    <aside class="card rightPanel">
      <div class="card-head">
        <h2>Risk Intelligence</h2>
        <span class="hint">Score + patterns</span>
      </div>

      <div class="riskBlock">
        <div class="riskTop">
          <div>
            <div class="smallLabel">RISK LEVEL</div>
            <div id="riskText" class="riskValue">LOW</div>
          </div>

          <div class="riskScoreBox">
            <div class="smallLabel">SCORE</div>
            <div id="riskScore" class="score">20</div>
          </div>
        </div>

        <div class="riskBar">
          <div id="riskFill" class="fill" style="width:20%"></div>
        </div>

        <div class="riskMeta">
          <div><b>Time-aware risk</b> is enabled (night = higher).</div>
          <div id="threatPattern" class="pattern">Pattern: Monitoring normal activity</div>
        </div>
      </div>

      <div class="radarCard">
        <div class="card-head compact">
          <h2>Threat Heat Radar</h2>
          <span class="hint">Visual indicator</span>
        </div>

        <div class="radar">
          <div class="ring r1"></div>
          <div class="ring r2"></div>
          <div class="ring r3"></div>
          <div class="sweep"></div>
          <div class="dot" id="radarDot"></div>
        </div>

        <div class="radarLegend">
          <span class="legend low">LOW</span>
          <span class="legend med">MED</span>
          <span class="legend high">HIGH</span>
        </div>
      </div>

      <div class="remoteCard" id="remoteCard">
        <div class="card-head">
          <h2>Remote Sensors / Actuators</h2>
          <span class="hint">IoT actions</span>
        </div>

        <p class="smallText">
          ARGUS supports remote sensors + IoT actuators for securing ATMs/organizations:
          <b>Gate/Door lock</b>, siren, lights, barrier control.
        </p>

        <div class="remoteBtns">
          <button class="btn danger" id="lockBtn">LOCK GATE</button>
          <button class="btn" id="unlockBtn">UNLOCK</button>
          <button class="btn" id="sirenBtn">SIREN ON</button>
        </div>

        <div class="remoteStatus" id="remoteStatus">Remote Status: <b>Standby</b></div>

        <div class="divider"></div>

        <div class="ackBox">
          <div class="smallLabel">Alert Acknowledgement</div>
          <input id="ackName" placeholder="Officer name (e.g., Aditya)" />
          <button id="ackBtn" class="btn primary">Acknowledge Alert</button>
          <div id="ackLog" class="ackLog">No acknowledgement yet.</div>
        </div>
      </div>

      <div class="panicCard">
        <div class="card-head">
          <h2>Emergency Override</h2>
          <span class="hint">Manual lockdown</span>
        </div>
        <button id="panicBtn" class="btn panic">MANUAL EMERGENCY LOCKDOWN</button>
        <div class="smallText dim">Use only if immediate threat is confirmed.</div>
      </div>
    </aside>

    <!-- BOTTOM: Detections + Confidence + Timeline + Reports -->
    <section class="card bottomWide">

      <div class="bottomGrid">
        <!-- Live Detections -->
        <div class="panel">
          <div class="card-head">
            <h2>Live Detections</h2>
            <span class="hint">Type + confidence</span>
          </div>
          <ul id="detList" class="detList">
            <li class="mutedItem">No threats detected</li>
          </ul>
        </div>

        <!-- Timeline -->
        <div class="panel">
          <div class="card-head">
            <h2>Threat Timeline</h2>
            <span class="hint">Recent severity</span>
          </div>
          <div id="timeline" class="timeline">
            <div class="timelineEmpty">No events yet</div>
          </div>

          <div class="card-head" style="margin-top:10px;">
            <h2>Incident Report</h2>
            <span class="hint">One click export</span>
          </div>

          <div class="reportBtns">
            <button id="reportBtn" class="btn primary">Generate Incident Report</button>
            <button id="clearBtn" class="btn">Clear Logs</button>
          </div>

          <div class="smallText dim">
            Exports a text report including time, ATM ID, detections, risk score, and actions.
          </div>
        </div>

        <!-- About -->
        <div class="panel">
          <div class="card-head">
            <h2>About ARGUS</h2>
            <span class="hint">Features overview</span>
          </div>

          <div class="aboutBox">
            <p>
              <b>ARGUS</b> monitors camera feeds and detects threats like <b>weapons</b>, <b>masked faces</b>,
              and <b>crowd anomalies</b>. It generates a dynamic risk score and can trigger alerts and remote security
              actions.
            </p>

            <div class="tags">
              <span class="tag">Threat Detection</span>
              <span class="tag">Real-time Alerts</span>
              <span class="tag">Evidence Snapshots</span>
              <span class="tag">Auto Lock</span>
              <span class="tag">Incident Reports</span>
              <span class="tag">Network Status</span>
              <span class="tag">Role Based UI</span>
            </div>

            <div class="creditFooter">
              <img src="nextgen-logo.png" alt="Next Gen Developers" />
              <span>Designed by <b>Next Gen Developers</b></span>
            </div>
          </div>
        </div>
      </div>

    </section>

  </main>

  <footer class="footer">
    ARGUS Security Intelligence © 2025 • ATM robbery prevention & organizational safety
  </footer>


  <!-- Automatic Incident Modal -->
  <style>
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: #1e1e24;
      border: 2px solid #ff4d4d;
      padding: 2rem;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 0 50px rgba(255, 77, 77, 0.5);
      animation: flashRed 1s infinite alternate;
    }

    @keyframes flashRed {
      from {
        border-color: #ff4d4d;
      }

      to {
        border-color: #ff0000;
      }
    }

    .danger-text {
      color: #ff4d4d;
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    .incident-row {
      margin: 0.5rem 0;
      font-size: 1.1rem;
      color: #fff;
    }

    .modal-actions {
      margin-top: 1.5rem;
      display: flex;
      gap: 1rem;
      justify-content: center;
    }
  </style>

  <div id="incidentModal" class="modal-overlay">
    <div class="modal-content">
      <h2 class="danger-text">⚠️ THREAT DETECTED</h2>
      <div id="incidentDetails">
        <!-- JS injected -->
      </div>
      <div class="modal-actions">
        <button id="closeModalBtn" class="btn">Acknowledge</button>
        <button id="modalDownloadBtn" class="btn primary">Download Report</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
</body>

</html>